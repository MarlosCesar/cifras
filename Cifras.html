<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Seletor de Cifras</title>
  <link rel="preload" href="https://cdn.tailwindcss.com" as="script">
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #3b82f6;
      --primary-dark: #2563eb;
      --primary-hover: #e0e7ff;
      --danger-color: #ef4444;
      --danger-dark: #dc2626;
      --gray-light: #f3f4f6;
      --gray-medium: #e5e7eb;
      --text-color-dark: #333333;
      --text-color-light: #4b5563;
      --shadow-base: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-primary: 0 0 10px rgba(37, 99, 235, 0.3);
      --header-bg: #1A202C;
      --header-text: #E2E8F0;
      --header-hover: #2D3748;
    }
    html, body {
      overflow-x: hidden;
      overflow-y: auto;
      background-color: var(--gray-light);
      font-family: 'Inter', sans-serif;
      color: var(--text-color-dark);
    }
    .header-professional {
      background-color: var(--header-bg);
      color: var(--header-text);
      box-shadow: var(--shadow-base);
    }
    .header-professional button {
      transition: background-color 0.3s ease, transform 0.1s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .header-professional button:hover {
      background-color: var(--header-hover);
    }
    .header-professional button:active {
      transform: scale(0.98);
    }
    .tabs {
      display: flex;
      gap: 0.5rem;
      border-bottom: 2px solid var(--gray-medium);
      margin-bottom: 1rem;
      flex-wrap: wrap;
      padding: 0 1rem;
    }
    .tab {
      padding: 0.65rem 1.2rem;
      cursor: pointer;
      border-radius: 0.5rem 0.5rem 0 0;
      background-color: #f9fafb;
      border: 1px solid transparent;
      border-bottom: 2px solid transparent;
      transition: all 0.2s ease;
      outline-offset: 2px;
      color: var(--text-color-light);
      font-weight: 500;
    }
    [role="tab"] {
      user-select: none;
    }
    .tab:hover, .tab:focus-visible {
      background-color: var(--primary-hover);
      border-color: var(--primary-color) transparent transparent;
      outline: none;
      color: var(--primary-dark);
    }
    .tab.active {
      background-color: white;
      border-color: var(--primary-color) var(--primary-color) white;
      font-weight: 600;
      color: var(--primary-dark);
      box-shadow: 0 -2px 5px rgba(0,0,0,0.05);
    }
    .image-container {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      border: 1px solid var(--gray-medium);
      border-radius: 0.75rem;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.2s ease;
      background-color: white;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      position: relative;
    }
    .image-container:focus-visible {
      outline: 2px solid var(--primary-color);
      outline-offset: 3px;
    }
    .image-container.selected {
      border-color: var(--primary-dark);
      box-shadow: var(--shadow-primary);
      background-color: var(--primary-hover);
    }
    .image-container .image-checkbox {
      position: absolute;
      top: 8px;
      left: 8px;
      z-index: 10;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
    }
    .show-checkboxes .image-container .image-checkbox {
      opacity: 1;
      pointer-events: all;
    }
    .show-checkboxes #select-all-container {
      display: flex !important;
    }
    .drag-over {
      border: 2px dashed var(--primary-dark) !important;
      background-color: rgba(59, 130, 246, 0.1) !important;
    }
    .image-container.dragging {
      opacity: 0.4;
      transform: scale(0.98);
    }
    .image-container img {
      width: 2.2cm;
      height: 3.3cm;
      object-fit: cover;
      border-radius: 0.35rem;
      flex-shrink: 0;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
      cursor: zoom-in;
    }
    .image-name {
      font-size: 0.95rem;
      color: var(--text-color-dark);
      flex-grow: 1;
      overflow-wrap: break-word;
      word-break: break-word;
      max-width: calc(100% - 2.2cm - 12px);
      line-height: 1.4;
      cursor: zoom-in;
    }
    .fullscreen-image {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.95);
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: zoom-out;
      z-index: 9999;
      touch-action: none;
    }
    .fullscreen-image img {
      max-width: 95%;
      max-height: 95%;
      object-fit: contain;
      transition: transform 0.25s ease;
      border-radius: 0.75rem;
      box-shadow: 0 0 25px rgba(0,0,0,0.8);
      transform-origin: center center;
    }
    .fullscreen-controls {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 15px;
      background: rgba(0,0,0,0.7);
      padding: 12px 20px;
      border-radius: 8px;
    }
    .zoom-btn {
      background: rgba(255,255,255,0.2);
      color: white;
      border: none;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s ease, transform 0.1s ease;
    }
    .zoom-btn:hover {
      background: rgba(255,255,255,0.3);
    }
    .zoom-btn:active {
      transform: scale(0.95);
    }
    .loading-spinner {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: rgba(0,0,0,0.6);
      padding: 20px;
      border-radius: 12px;
      z-index: 10000;
      color: white;
    }
    .loading-spinner.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #status-message {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
      pointer-events: none;
      text-align: center;
    }
    #status-message.show {
      opacity: 1;
    }
    @media (max-width: 640px) {
      .header-professional h1 { font-size: 1.5rem; }
      .header-professional .space-x-4 { gap: 0.5rem; }
      .header-professional button { padding: 0.6rem; }
      .tabs { flex-wrap: wrap; justify-content: center; gap: 0.35rem; padding: 0 0.5rem; }
      .tab { padding: 0.5rem 0.8rem; font-size: 0.9rem; }
      .main-content-area { padding: 0.75rem; }
      .image-container { flex-direction: row; align-items: center; gap: 10px; padding: 10px; }
      .image-container img { width: 1.8cm; height: 2.7cm; }
      .image-name { font-size: 0.875rem; max-width: calc(100% - 1.8cm - 10px); }
      .flex-wrap.gap-2 { flex-direction: column; width: 100%; }
      .flex-wrap.gap-2 button { width: 100%; justify-content: center; }
      .flex-wrap.gap-2 button i { margin-right: 0.5rem; }
      .fullscreen-controls { flex-direction: row; gap: 10px; padding: 10px 15px; }
      .zoom-btn { width: 45px; height: 45px; font-size: 22px; }
    }
    @media (min-width: 641px) and (max-width: 1024px) {
      .tabs { justify-content: flex-start; padding: 0 1.5rem; }
      .tab { padding: 0.6rem 1.1rem; font-size: 0.95rem; }
      .image-container { padding: 10px; gap: 10px; }
      .image-container img { width: 2cm; height: 3cm; }
      .image-name { font-size: 0.9rem; max-width: calc(100% - 2cm - 10px); }
    }
  </style>
</head>
<body class="bg-gray-100 font-sans antialiased">
  <header class="header-professional p-4">
    <div class="container mx-auto flex justify-between items-center">
      <h1 class="text-2xl font-semibold tracking-wide">Seletor de Cifras</h1>
      <div class="flex items-center space-x-4">
        <button id="sync-btn" class="p-2 rounded-full" aria-label="Sincronizar" title="Sincronizar">
          <i class="fas fa-sync-alt text-lg" aria-hidden="true"></i>
        </button>
        <button id="settings-btn" class="p-2 rounded-full" aria-label="Configurações" title="Configurações">
          <i class="fas fa-cog text-lg" aria-hidden="true"></i>
        </button>
      </div>
    </div>
  </header>
  <main class="container mx-auto p-4 flex flex-col gap-4 main-content-area" role="main">
    <section class="w-full bg-white rounded-xl shadow-md overflow-hidden flex flex-col" aria-label="Seletor de músicas e imagens">
      <div class="p-4 bg-gray-50 border-b flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
        <h2 class="font-semibold text-xl text-gray-700">Minhas Cifras</h2>
        <div class="flex flex-wrap gap-2 justify-end">
          <button id="open-cloud-folder" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition flex items-center" aria-label="Buscar cifras na nuvem (OneDrive)" title="Buscar em Nuvem">
            <i class="fas fa-cloud mr-2" aria-hidden="true"></i> Buscar em Nuvem
          </button>
          <button id="open-file-dialog" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition flex items-center" aria-label="Buscar cifras localmente" title="Buscar cifras localmente">
            <i class="fas fa-folder-open mr-2" aria-hidden="true"></i> Buscar Local
          </button>
          <input type="file" id="file-input" class="hidden" accept="image/*" multiple aria-hidden="true" tabindex="-1" />
        </div>
      </div>
      <nav class="tabs" id="tabs-container" role="tablist" aria-label="Abas das categorias de cifras"></nav>
      <div class="p-4 flex flex-col gap-4 flex-1">
        <div id="select-all-container" class="flex flex-wrap items-center gap-4 mb-2 hidden">
          <label class="inline-flex items-center gap-2 cursor-pointer text-gray-700 font-medium" for="select-all">
            <input type="checkbox" id="select-all" class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500" aria-label="Selecionar todas as imagens" />
            <span>Selecionar todas</span>
          </label>
          <button id="clear-selection-btn" class="bg-gray-400 text-white px-4 py-2 rounded-lg hover:bg-gray-500 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center" disabled>
            <i class="fas fa-undo mr-2" aria-hidden="true"></i> Limpar seleção
          </button>
          <button id="delete-selected-btn" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center" disabled>
            <i class="fas fa-trash-alt mr-2" aria-hidden="true"></i> Excluir selecionadas
          </button>
        </div>
        <div id="image-list" class="flex flex-col gap-4" aria-live="polite" aria-atomic="true">
          <p class="text-center text-gray-500 py-8">Nenhuma imagem encontrada nesta categoria.</p>
        </div>
      </div>
    </section>
  </main>
  <div id="loading-spinner" class="loading-spinner">
    <i class="fas fa-spinner fa-spin fa-3x text-blue-600" aria-hidden="true"></i>
    <span class="sr-only">Carregando...</span>
  </div>
  <div id="status-message" aria-live="polite"></div>
  <script>
    // Cache de elementos DOM
    const DOM = {
      tabsContainer: document.getElementById('tabs-container'),
      imageList: document.getElementById('image-list'),
      fileInput: document.getElementById('file-input'),
      openFileDialogButton: document.getElementById('open-file-dialog'),
      openCloudFolderButton: document.getElementById('open-cloud-folder'),
      selectAllContainer: document.getElementById('select-all-container'),
      selectAllCheckbox: document.getElementById('select-all'),
      deleteSelectedBtn: document.getElementById('delete-selected-btn'),
      clearSelectionBtn: document.getElementById('clear-selection-btn'),
      syncBtn: document.getElementById('sync-btn'),
      settingsBtn: document.getElementById('settings-btn'),
      loadingSpinner: document.getElementById('loading-spinner'),
      statusMessage: document.getElementById('status-message'),
      body: document.body,
    };

    // Abas desejadas
    const tabs = ["Domingo Manhã", "Domingo Noite", "Segunda", "Quarta", "Culto Jovem", "Santa Ceia", "Outros"];

    // Estado otimizado com Map/Set
    let imageGalleryByTab = new Map();
    let selectedImagesByTab = new Map();
    let currentTab = tabs[0];

    tabs.forEach(tab => {
      imageGalleryByTab.set(tab, []);
      selectedImagesByTab.set(tab, new Set());
    });

    // Utils
    const Utils = {
      removeFileExtension: filename => filename.replace(/\.[^/.]+$/, ""),
      showStatus: message => {
        DOM.statusMessage.textContent = message;
        DOM.statusMessage.classList.add('show');
        setTimeout(() => DOM.statusMessage.classList.remove('show'), 3000);
      },
      objectURLCache: new Map(),
      revokeObjectURL: (url) => {
        if (Utils.objectURLCache.has(url)) {
          URL.revokeObjectURL(url);
          Utils.objectURLCache.delete(url);
        }
      },
      createObjectURL: (blob) => {
        const url = URL.createObjectURL(blob);
        Utils.objectURLCache.set(url, true);
        return url;
      }
    };

    // Gerenciamento de abas
    const TabManager = {
      switchTab: (tab) => {
        if (!tabs.includes(tab)) return;
        currentTab = tab;
        UI.updateTabsUI();
        UI.renderImages();
      }
    };

    // IndexedDB (simples para imagens)
    const DB_NAME = 'ImageSelectorDB';
    const DB_VERSION = 2;
    const STORE_IMAGES = 'images';

    const IndexedDBManager = {
      db: null,
      open: () => new Promise((resolve, reject) => {
        if (IndexedDBManager.db) {
          resolve(IndexedDBManager.db);
          return;
        }
        const request = indexedDB.open(DB_NAME, DB_VERSION);
        request.onupgradeneeded = (event) => {
          const db = event.target.result;
          if (!db.objectStoreNames.contains(STORE_IMAGES)) {
            db.createObjectStore(STORE_IMAGES, { keyPath: 'name' });
          }
        };
        request.onsuccess = (event) => {
          IndexedDBManager.db = event.target.result;
          resolve(IndexedDBManager.db);
        };
        request.onerror = (event) => {
          console.error('IndexedDB error:', event.target.errorCode);
          reject(event.target.errorCode);
        };
      }),
      addImageBlob: (imageName, blob) => new Promise(async (resolve, reject) => {
        try {
          const db = await IndexedDBManager.open();
          const transaction = db.transaction([STORE_IMAGES], 'readwrite');
          const store = transaction.objectStore(STORE_IMAGES);
          const request = store.put({ name: imageName, blob: blob });
          request.onsuccess = () => resolve();
          request.onerror = (event) => reject(event.target.error);
        } catch (e) { reject(e); }
      }),
      getImageBlob: (imageName) => new Promise(async (resolve, reject) => {
        try {
          const db = await IndexedDBManager.open();
          const store = db.transaction([STORE_IMAGES], 'readonly').objectStore(STORE_IMAGES);
          const request = store.get(imageName);
          request.onsuccess = (event) => resolve(event.target.result ? event.target.result.blob : null);
          request.onerror = (event) => reject(event.target.error);
        } catch (e) { reject(e); }
      }),
      deleteImageBlob: (imageName) => new Promise(async (resolve, reject) => {
        try {
          const db = await IndexedDBManager.open();
          const store = db.transaction([STORE_IMAGES], 'readwrite').objectStore(STORE_IMAGES);
          const request = store.delete(imageName);
          request.onsuccess = () => resolve();
          request.onerror = (event) => reject(event.target.error);
        } catch (e) { reject(e); }
      }),
    };

    // UI
    const UI = {
      showLoading: () => DOM.loadingSpinner.classList.add('active'),
      hideLoading: () => DOM.loadingSpinner.classList.remove('active'),
      createTabs: () => {
        DOM.tabsContainer.innerHTML = '';
        tabs.forEach((tab, index) => {
          const tabBtn = document.createElement('button');
          tabBtn.className = 'tab';
          tabBtn.setAttribute('role', 'tab');
          tabBtn.setAttribute('tabindex', index === 0 ? '0' : '-1');
          tabBtn.setAttribute('aria-selected', index === 0 ? 'true' : 'false');
          tabBtn.id = `tab-${tab.replace(/\s+/g, '-').toLowerCase()}`;
          tabBtn.textContent = tab;
          tabBtn.addEventListener('click', () => TabManager.switchTab(tab));
          DOM.tabsContainer.appendChild(tabBtn);
        });
        UI.updateTabsUI();
      },
      updateTabsUI: () => {
        const buttons = DOM.tabsContainer.querySelectorAll('.tab');
        buttons.forEach(btn => {
          const isActive = btn.textContent === currentTab;
          btn.classList.toggle('active', isActive);
          btn.setAttribute('aria-selected', isActive);
          btn.setAttribute('tabindex', isActive ? '0' : '-1');
        });
      },
      renderImages: async () => {
        DOM.imageList.querySelectorAll('img[data-object-url]').forEach(img => {
          Utils.revokeObjectURL(img.dataset.objectUrl);
        });
        const imageNames = imageGalleryByTab.get(currentTab) || [];
        const fragment = document.createDocumentFragment();
        if (imageNames.length === 0) {
          const p = document.createElement('p');
          p.className = 'text-center text-gray-500 py-8';
          p.textContent = 'Nenhuma imagem encontrada nesta categoria.';
          fragment.appendChild(p);
        } else {
          for (const imageName of imageNames) {
            const blob = await IndexedDBManager.getImageBlob(imageName);
            if (blob) {
              fragment.appendChild(UI.createImageElement(imageName, blob));
            }
          }
        }
        DOM.imageList.innerHTML = '';
        DOM.imageList.appendChild(fragment);
      },
      createImageElement: (imageName, imageBlob) => {
        const container = document.createElement('div');
        container.className = 'image-container';
        container.setAttribute('draggable', 'true');
        container.setAttribute('tabindex', '0');
        container.dataset.name = imageName;

        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.className = 'form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500 image-checkbox';
        checkbox.setAttribute('aria-label', `Selecionar ${Utils.removeFileExtension(imageName)}`);
        checkbox.checked = selectedImagesByTab.get(currentTab).has(imageName);
        checkbox.addEventListener('change', (e) => {
          e.stopPropagation();
          // ... lógica de seleção ...
        });

        container.appendChild(checkbox);

        const img = document.createElement('img');
        const objectURL = Utils.createObjectURL(imageBlob);
        img.src = objectURL;
        img.dataset.objectUrl = objectURL;
        img.alt = Utils.removeFileExtension(imageName);
        img.title = "Clique para ampliar";
        img.addEventListener('click', (e) => {
          e.stopPropagation();
          UI.openFullscreen(objectURL, img.alt);
        });

        container.appendChild(img);

        const nameSpan = document.createElement('span');
        nameSpan.className = 'image-name';
        nameSpan.textContent = Utils.removeFileExtension(imageName);
        nameSpan.title = "Clique para ampliar";
        container.appendChild(nameSpan);

        return container;
      },
      openFullscreen: (src, alt) => {
        const overlay = document.createElement('div');
        overlay.className = 'fullscreen-image';
        overlay.setAttribute('role', 'dialog');
        overlay.setAttribute('aria-modal', 'true');
        overlay.setAttribute('aria-label', `Visualização da imagem ${alt}`);

        const img = document.createElement('img');
        img.src = src;
        img.alt = alt;
        img.tabIndex = 0;
        img.style.transform = 'scale(1)';

        const controls = document.createElement('div');
        controls.className = 'fullscreen-controls';

        const zoomInBtn = document.createElement('button');
        zoomInBtn.className = 'zoom-btn';
        zoomInBtn.innerHTML = '<i class="fas fa-search-plus"></i>';
        zoomInBtn.setAttribute('aria-label', 'Zoom in');

        const zoomOutBtn = document.createElement('button');
        zoomOutBtn.className = 'zoom-btn';
        zoomOutBtn.innerHTML = '<i class="fas fa-search-minus"></i>';
        zoomOutBtn.setAttribute('aria-label', 'Zoom out');

        const resetZoomBtn = document.createElement('button');
        resetZoomBtn.className = 'zoom-btn';
        resetZoomBtn.innerHTML = '<i class="fas fa-expand"></i>';
        resetZoomBtn.setAttribute('aria-label', 'Reset zoom');

        let scale = 1;
        let translateX = 0, translateY = 0;
        let isDragging = false;
        let startPoint = { x: 0, y: 0 };

        const updateTransform = () => {
          img.style.transform = `scale(${scale}) translate(${translateX}px, ${translateY}px)`;
        };

        zoomInBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          scale = Math.min(scale * 1.2, 5);
          updateTransform();
        });
        zoomOutBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          scale = Math.max(scale / 1.2, 1);
          if (scale === 1) {
            translateX = 0;
            translateY = 0;
          }
          updateTransform();
        });
        resetZoomBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          scale = 1;
          translateX = 0;
          translateY = 0;
          updateTransform();
        });

        controls.appendChild(zoomInBtn);
        controls.appendChild(zoomOutBtn);
        controls.appendChild(resetZoomBtn);

        overlay.appendChild(img);
        overlay.appendChild(controls);

        // Função para sair do fullscreen e remover overlay
        const closeFullscreen = () => {
          if (document.fullscreenElement) {
            document.exitFullscreen();
          }
          overlay.remove();
          document.removeEventListener('keydown', keyListener);
        };

        overlay.addEventListener('click', closeFullscreen);
        img.addEventListener('click', (e) => e.stopPropagation());
        function keyListener(e) {
          if (e.key === 'Escape') closeFullscreen();
        }
        document.addEventListener('keydown', keyListener);

        img.addEventListener('mousedown', (e) => {
          if (scale > 1) {
            isDragging = true;
            startPoint = { x: e.clientX - translateX, y: e.clientY - translateY };
            img.style.cursor = 'grabbing';
            e.preventDefault();
          }
        });
        window.addEventListener('mousemove', (e) => {
          if (isDragging) {
            translateX = e.clientX - startPoint.x;
            translateY = e.clientY - startPoint.y;
            updateTransform();
          }
        });
        window.addEventListener('mouseup', () => {
          isDragging = false;
          img.style.cursor = 'zoom-in';
        });

        img.addEventListener('touchstart', (e) => {
          if (scale > 1 && e.touches.length === 1) {
            isDragging = true;
            startPoint = { x: e.touches[0].clientX - translateX, y: e.touches[0].clientY - translateY };
            img.style.cursor = 'grabbing';
            e.preventDefault();
          }
        }, { passive: false });
        img.addEventListener('touchmove', (e) => {
          if (isDragging && e.touches.length === 1) {
            translateX = e.touches[0].clientX - startPoint.x;
            translateY = e.touches[0].clientY - startPoint.y;
            updateTransform();
            e.preventDefault();
          }
        }, { passive: false });
        img.addEventListener('touchend', () => {
          isDragging = false;
          img.style.cursor = 'zoom-in';
        });

        document.body.appendChild(overlay);

        // Ativa Fullscreen nativo
        if (overlay.requestFullscreen) {
          overlay.requestFullscreen();
        } else if (overlay.webkitRequestFullscreen) {
          overlay.webkitRequestFullscreen();
        } else if (overlay.msRequestFullscreen) {
          overlay.msRequestFullscreen();
        }
      }
    };

    // Inicialização
    document.addEventListener('DOMContentLoaded', () => {
      UI.createTabs();
      UI.renderImages();
    });

    // Botão de buscar local
    DOM.openFileDialogButton.addEventListener('click', () => {
      DOM.fileInput.click();
    });

    // Carregar imagens do usuário
    DOM.fileInput.addEventListener('change', async (event) => {
      const files = Array.from(event.target.files);
      for (const file of files) {
        await IndexedDBManager.addImageBlob(file.name, file);
        imageGalleryByTab.get(currentTab).push(file.name);
      }
      UI.renderImages();
      Utils.showStatus('Imagens adicionadas!');
      DOM.fileInput.value = '';
    });

    // Botão de buscar em nuvem
    DOM.openCloudFolderButton.addEventListener('click', () => {
      window.open('https://1drv.ms/f/c/a71268bf66931c02/EpYyUsypAQhGgpWC9YuvE54BD_o9NX9tRar0piSzq4V4Xg', '_blank');
    });
  </script>
</body>
</html>